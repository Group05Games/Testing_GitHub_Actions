name: Test JSON
on: push
jobs:
  test_json:
    runs-on: windows-latest
    outputs:
      diff: ${{ steps.output-json.outputs.diff}}

    steps:
      - name: output json
        id: output-json
        shell: pwsh
        run: |
          #$jsonThing = '["one", "two", "three"]'
          $jsonThing = "one two three"
          #$jsonThing = "one"
          #$jsonThing = ""
          $jsonThing = $jsonThing.split(" ")
          $jsonThing = ConvertTo-Json -Compress $jsonThing
          echo "::set-output name=diff::$jsonThing"

  test-parse:
    needs: test_json
    runs-on: windows-latest
    steps:
      - name: input and print json
        run: |
          echo ${{ fromJSON(needs.test_json.outputs.diff) }}

  matrix-test:
    needs: test_json
    runs-on: windows-latest
    strategy:
      matrix: 
        package: ${{ fromJSON(needs.test_json.outputs.diff) }}
    environmet: Release ${{ matrix.package }}
    name: matrix-test-${{ matrix.package }}

    steps:
      - run: echo "${{ matrix.package }}"